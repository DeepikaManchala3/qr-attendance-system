{% extends "base.html" %}
{% block title %}Books{% endblock %}
{% block content %}
<div class="card">
  <h2>Books</h2>
  <form method="get" style="display:flex; gap:10px; margin:10px 0;">
    <input class="input" name="q" placeholder="Search by title/author/IDâ€¦" value="{{ q }}">
    <button class="btn">Search</button>
  </form>

  <form method="post" action="{{ url_for('add_book') }}" class="grid grid-2" style="margin:14px 0;">
    <input class="input" name="title" placeholder="Title" required>
    <input class="input" name="author" placeholder="Author">
    <input class="input" name="bid" placeholder="Custom Book ID (optional)">
    <button class="btn">+ Add Book & Generate QR</button>
  </form>

  <table class="table">
    <thead><tr><th>ID</th><th>Title</th><th>Author</th><th>Available</th><th>QR</th></tr></thead>
    <tbody>
      {% for b in books %}
      <tr>
        <td>{{ b.bid }}</td>
        <td>{{ b.title }}</td>
        <td>{{ b.author or "-" }}</td>
        <td>
          {% if b.available %}
          <span class="badge ok">Yes</span>
          {% else %}
          <span class="badge no">No</span>
          {% endif %}
        </td>
        <td>
          <a href="{{ url_for('qrcodes', filename='book_' ~ b.bid ~ '.png') }}" target="_blank">View QR</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
